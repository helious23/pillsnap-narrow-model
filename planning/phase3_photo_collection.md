# ğŸ“· Phase 3: ì‹¤ì œ ì•½í’ˆ ì‚¬ì§„ ìˆ˜ì§‘ ìƒì„¸ ê³„íš

## ğŸ¯ ëª©í‘œ
100ê°œ ì•½í’ˆì˜ **ê³ í’ˆì§ˆ ì‹¤ì‚¬ì§„ 1,000ì¥ ì´ìƒ** í™•ë³´ ë° í’ˆì§ˆ ê²€ì¦ ì™„ë£Œ

## ğŸ“… ì¼ì •: 2024-10-26 ~ 2024-10-27 (2ì¼ íŒŒì¼ëŸ¿) + 2024-10-28 ~ 2024-11-01 (5ì¼ ë³¸ì´¬ì˜)

## ğŸ“Š ìˆ˜ì§‘ ëª©í‘œ ë° ë©”íŠ¸ë¦­

| êµ¬ë¶„ | ëª©í‘œ | ìµœì†Œ ìš”êµ¬ì‚¬í•­ | í’ˆì§ˆ ê¸°ì¤€ |
|------|------|--------------|----------|
| **íŒŒì¼ëŸ¿** | 30ê°œ ì•½í’ˆ Ã— 10ì¥ = 300ì¥ | 270ì¥ | Aë“±ê¸‰ 60% |
| **ë³¸ì´¬ì˜** | 70ê°œ ì•½í’ˆ Ã— 15ì¥ = 1,050ì¥ | 700ì¥ | Aë“±ê¸‰ 70% |
| **ì „ì²´** | 100ê°œ ì•½í’ˆ, 1,350ì¥ | 1,000ì¥ | Aë“±ê¸‰ 70% |

## ğŸ”„ ìˆ˜ì§‘ ì›Œí¬í”Œë¡œìš°

```mermaid
graph LR
    A[ì•½í’ˆ í™•ë³´] --> B[ì‚¬ì „ ì¤€ë¹„]
    B --> C[ì´¬ì˜ ì„¸ì…˜]
    C --> D[ì‹¤ì‹œê°„ QC]
    D --> E{í’ˆì§ˆ íŒì •}
    E -->|A/Bë“±ê¸‰| F[ì—…ë¡œë“œ]
    E -->|Cë“±ê¸‰| G[ì¬ì´¬ì˜]
    G --> C
    F --> H[ë©”íƒ€ë°ì´í„°]
    H --> I[ê²€ì¦ ì™„ë£Œ]
```

## ğŸ“‹ ìƒì„¸ ì‘ì—…

### Part A: íŒŒì¼ëŸ¿ í…ŒìŠ¤íŠ¸ (2ì¼)

---

#### Task 1: ìƒìœ„ 30ê°œ ì•½í’ˆ ì‹¤ë¬¼ í™•ë³´

**í™•ë³´ ì „ëµ**:

**1ì°¨ ì†ŒìŠ¤ - ì•½êµ­ êµ¬ë§¤ (20ê°œ)**:
```yaml
ë°©ë¬¸ ì•½êµ­: 3-4ê³³ (ì§€ì—­ ë¶„ì‚°)
êµ¬ë§¤ ë°©ë²•:
  - ì¼ë°˜ì˜ì•½í’ˆ: ì§ì ‘ êµ¬ë§¤
  - ì „ë¬¸ì˜ì•½í’ˆ: ìƒ˜í”Œ ìš”ì²­ (ì•½ì‚¬ í˜‘ì¡°)
ì˜ˆìƒ ë¹„ìš©: 30,000-50,000ì›
ì¤€ë¹„ë¬¼:
  - êµ¬ë§¤ ë¦¬ìŠ¤íŠ¸ (ì¸ì‡„ë¬¼)
  - ì•½í’ˆ ë³´ê´€ìš© ì§€í¼ë°±
  - ë¼ë²¨ ìŠ¤í‹°ì»¤
```

**2ì°¨ ì†ŒìŠ¤ - ì˜¨ë¼ì¸ (10ê°œ)**:
```yaml
êµ¬ë§¤ì²˜:
  - ì•½êµ­ ì˜¨ë¼ì¸ëª° (ì¼ë°˜ì˜ì•½í’ˆ)
  - ì˜ë£Œê¸°ê¸° ë„ë§¤ìƒ (ìƒ˜í”ŒíŒ©)
ì˜ˆìƒ ë¹„ìš©: 20,000-30,000ì›
ë°°ì†¡ ê¸°ê°„: 1-2ì¼
```

**ì•½í’ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ**:
```python
# ì•½í’ˆ ê´€ë¦¬ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ êµ¬ì¡°
drug_inventory = {
    "K001234": {
        "name": "íƒ€ì´ë ˆë†€500mg",
        "quantity": 3,  # í™•ë³´ ìˆ˜ëŸ‰
        "source": "ì•½êµ­A",
        "purchase_date": "2024-10-26",
        "expiry_date": "2025-12-31",
        "storage_location": "Box_A_01",
        "photo_status": "pending"  # pending/partial/complete
    }
}
```

**ë³´ê´€ ë°©ë²•**:
- ì•½í’ˆë³„ ê°œë³„ ì§€í¼ë°± ë³´ê´€
- K-CODE ë¼ë²¨ ë¶€ì°©
- ì˜¨ë„: 15-25Â°C (ì‹¤ì˜¨)
- ìŠµë„: 40-60%
- ì§ì‚¬ê´‘ì„  ì°¨ë‹¨

---

#### Task 2: 30ê°œ ì•½í’ˆ Ã— 10ì¥ = 300ì¥ ì´¬ì˜

**ì´¬ì˜ ê³„íš**:

**ì¼ì¼ ìŠ¤ì¼€ì¤„**:
| ì‹œê°„ | í™œë™ | ëª©í‘œ |
|------|------|------|
| 09:00-09:30 | ì¥ë¹„ ì„¸íŒ… | ì¡°ëª…, ì¹´ë©”ë¼ ìº˜ë¦¬ë¸Œë ˆì´ì…˜ |
| 09:30-12:00 | ì˜¤ì „ ì´¬ì˜ | 10ê°œ ì•½í’ˆ (100ì¥) |
| 12:00-13:00 | ì ì‹¬ ë° ë°ì´í„° ë°±ì—… | |
| 13:00-16:00 | ì˜¤í›„ ì´¬ì˜ | 10ê°œ ì•½í’ˆ (100ì¥) |
| 16:00-17:00 | í’ˆì§ˆ ê²€í†  | QC ë° ì¬ì´¬ì˜ ë¦¬ìŠ¤íŠ¸ |
| 17:00-18:00 | ë°ì´í„° ì—…ë¡œë“œ | Supabase ë™ê¸°í™” |

**ì´¬ì˜ í”„ë¡œí† ì½œ**:
```python
class PhotoSession:
    def capture_drug(self, drug_id: str):
        angles = {
            'front': 3,   # ì •ë©´ 3ì¥
            'back': 3,    # í›„ë©´ 3ì¥
            'side': 4     # ì¸¡ë©´ 4ì¥ (90ë„ì”© íšŒì „)
        }

        for angle, count in angles.items():
            for i in range(count):
                # 1. ì•½í’ˆ ë°°ì¹˜
                self.position_drug(angle)

                # 2. ì¡°ëª… í™•ì¸
                self.check_lighting()

                # 3. ì´ˆì  ë§ì¶”ê¸°
                self.lock_focus()

                # 4. ì´¬ì˜
                photo = self.capture()

                # 5. ì¦‰ì‹œ í’ˆì§ˆ ì²´í¬
                quality = self.check_quality(photo)

                if quality.grade == 'C':
                    # ì¦‰ì‹œ ì¬ì´¬ì˜
                    self.retake(angle, i)

                # 6. ë©”íƒ€ë°ì´í„° ê¸°ë¡
                self.save_metadata(drug_id, angle, quality)
```

**ê°ë„ë³„ ì´¬ì˜ ê°€ì´ë“œ**:

**ì •ë©´ (Front)**:
- ì£¼ìš” ê°ì¸/ë¡œê³  ì¤‘ì‹¬
- ìˆ˜í‰ ì •ë ¬ í™•ì¸
- 3ì¥: ê¸°ë³¸, Â±5ë„ íšŒì „

**í›„ë©´ (Back)**:
- ì œì¡°ì‚¬ ì •ë³´ í¬í•¨
- ë¶„í• ì„  ëª…í™•íˆ
- 3ì¥: ê¸°ë³¸, ì•½ê°„ ìœ„/ì•„ë˜

**ì¸¡ë©´ (Side)**:
- ë‘ê»˜ íŒŒì•… ê°€ëŠ¥
- 90ë„ì”© íšŒì „
- 4ì¥: 0Â°, 90Â°, 180Â°, 270Â°

---

#### Task 3: QC ê²€ì¦ - A/B/C ë“±ê¸‰ ë¶„ë¥˜

**í’ˆì§ˆ ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸**:

**Aë“±ê¸‰ ê¸°ì¤€ (í•™ìŠµ ë°ì´í„°)**:
- [x] Laplacian Score > 150
- [x] ë…¸ì¶œ ì •ìƒ (íˆìŠ¤í† ê·¸ë¨ ì¤‘ì•™)
- [x] ì¤‘ì•™ ì •ë ¬ (Â±30px)
- [x] ë°°ê²½ ê· ì¼
- [x] ê·¸ë¦¼ì ìµœì†Œ
- [x] ì „ì²´ ì•½í’ˆ visible
- [x] í•´ìƒë„ > 2000px

**Bë“±ê¸‰ ê¸°ì¤€ (ë³´ì¡° ë°ì´í„°)**:
- [x] Laplacian Score 100-150
- [x] ë…¸ì¶œ ì•½ê°„ ë¶€ì¡±/ê³¼ë‹¤
- [x] ì •ë ¬ ì•½ê°„ ë²—ì–´ë‚¨ (Â±50px)
- [ ] ë¯¸ì„¸í•œ ê·¸ë¦¼ì
- [x] ì•½í’ˆ 90% ì´ìƒ visible

**Cë“±ê¸‰ (ì¬ì´¬ì˜ í•„ìš”)**:
- [ ] Laplacian Score < 100 (íë¦¼)
- [ ] ì‹¬ê°í•œ ë…¸ì¶œ ë¬¸ì œ
- [ ] ì¤‘ì•™ ì •ë ¬ ì‹¤íŒ¨
- [ ] ì•½í’ˆ ì¼ë¶€ ì˜ë¦¼
- [ ] ë°°ê²½ ì˜¤ì—¼

**í’ˆì§ˆ ë¶„í¬ ë¶„ì„**:
```python
def analyze_quality_distribution(photos):
    stats = {
        'A': 0, 'B': 0, 'C': 0,
        'by_drug': {},
        'by_angle': {'front': {}, 'back': {}, 'side': {}},
        'common_issues': []
    }

    for photo in photos:
        grade = photo.quality_grade
        stats[grade] += 1

        # ì•½í’ˆë³„ í†µê³„
        drug = photo.drug_id
        if drug not in stats['by_drug']:
            stats['by_drug'][drug] = {'A': 0, 'B': 0, 'C': 0}
        stats['by_drug'][drug][grade] += 1

        # ê°ë„ë³„ í†µê³„
        angle = photo.angle
        stats['by_angle'][angle][grade] = \
            stats['by_angle'][angle].get(grade, 0) + 1

        # ë¬¸ì œ íŒ¨í„´ ìˆ˜ì§‘
        if grade == 'C':
            stats['common_issues'].append(photo.issue_type)

    return stats
```

**ì¬ì´¬ì˜ ìš°ì„ ìˆœìœ„**:
1. **ê¸´ê¸‰**: ì•½í’ˆë‹¹ Aë“±ê¸‰ < 3ì¥
2. **ë†’ìŒ**: íŠ¹ì • ê°ë„ ëˆ„ë½
3. **ë³´í†µ**: Bë“±ê¸‰ > 50%
4. **ë‚®ìŒ**: ì¶”ê°€ ìƒ˜í”Œ í•„ìš”

---

#### Task 4: ì´¬ì˜ í”„ë¡œí† ì½œ ê°œì„ 

**ë¬¸ì œì  ë¶„ì„ ë° ê°œì„ **:

**ì¡°ëª… ë¬¸ì œ**:
```yaml
ë¬¸ì œ:
  - ë°˜ì‚¬ê´‘ìœ¼ë¡œ ê°ì¸ ë¶ˆëª…í™•
  - ê·¸ë¦¼ì ë°œìƒ

í•´ê²°:
  - Diffuser ì¶”ê°€ (íŠ¸ë ˆì´ì‹± í˜ì´í¼)
  - ë§ë¼ì´íŠ¸ ê°ë„ ì¡°ì • (15Â° ê¸°ìš¸ì„)
  - ë³´ì¡° LED ì¶”ê°€ (ì¸¡ë©´ fill light)
```

**ì´ˆì  ë¬¸ì œ**:
```yaml
ë¬¸ì œ:
  - ì†Œí˜• ì•½í’ˆ ì´ˆì  ì‹¤íŒ¨
  - ê³¡ë©´ ì•½í’ˆ ë¶€ë¶„ blur

í•´ê²°:
  - Focus stacking ê¸°ë²• ì ìš©
  - ì¡°ë¦¬ê°œ ì¡°ì • (f/8 â†’ f/11)
  - ë§¤í¬ë¡œ ë Œì¦ˆ í´ë¦½ ì¶”ê°€ ê³ ë ¤
```

**ì •ë ¬ ë¬¸ì œ**:
```yaml
ë¬¸ì œ:
  - ì›í˜• ì•½í’ˆ íšŒì „
  - ìº¡ìŠ ê¸°ìš¸ì–´ì§

í•´ê²°:
  - ì•½í’ˆ ê³ ì •ìš© íˆ¬ëª… ì•„í¬ë¦´ ê°€ì´ë“œ
  - ì‹¤ë¦¬ì½˜ íŒ¨ë“œ ì‚¬ìš© (ë¯¸ë„ëŸ¼ ë°©ì§€)
  - AR ì •ë ¬ ê°€ì´ë“œ ì•± ê¸°ëŠ¥ ì¶”ê°€
```

**í”„ë¡œí† ì½œ v2.0 ì—…ë°ì´íŠ¸**:
```markdown
## ê°œì„ ëœ ì´¬ì˜ í”„ë¡œí† ì½œ v2.0

### ì‚¬ì „ ì¤€ë¹„ (5ë¶„)
1. ë Œì¦ˆ ì²­ì†Œ (ë§ˆì´í¬ë¡œíŒŒì´ë²„)
2. ì¡°ëª… ì›Œë°ì—… (2ë¶„)
3. í™”ì´íŠ¸ë°¸ëŸ°ìŠ¤ ìº˜ë¦¬ë¸Œë ˆì´ì…˜
4. í…ŒìŠ¤íŠ¸ ì´¬ì˜ (í‘œì¤€ ì°¸ì¡°ë¬¼)

### ì´¬ì˜ ë‹¨ê³„ (ì•½í’ˆë‹¹ 3ë¶„)
1. ì•½í’ˆ ì‹ë³„ ë° ë¼ë²¨ í™•ì¸
2. ë¨¼ì§€ ì œê±° (ì—ì–´ ë¸”ë¡œì–´)
3. ìœ„ì¹˜ ì¡°ì • (ê°€ì´ë“œ í™œìš©)
4. ì¡°ëª… í™•ì¸ (ê·¸ë¦¼ì ì²´í¬)
5. í¬ì»¤ìŠ¤ ë½ (ì¤‘ì•™ì )
6. ì—°ì† ì´¬ì˜ (ë²„ìŠ¤íŠ¸ ëª¨ë“œ 3ì¥)
7. ì¦‰ì‹œ í’ˆì§ˆ í™•ì¸ (ì•±)
8. ë‹¤ìŒ ê°ë„ ì „í™˜

### í›„ì²˜ë¦¬ (10ë¶„/100ì¥)
1. ìë™ í’ˆì§ˆ ë¶„ë¥˜
2. ë©”íƒ€ë°ì´í„° ê²€ì¦
3. ì¬ì´¬ì˜ ë¦¬ìŠ¤íŠ¸ ìƒì„±
4. í´ë¼ìš°ë“œ ë™ê¸°í™”
```

---

### Part B: ë³¸ê²© ìˆ˜ì§‘ (5ì¼)

---

#### Task 5: 100ê°œ ì•½í’ˆ í™•ë³´ ê³„íš ìˆ˜ë¦½

**ì¡°ë‹¬ ê³„íš**:

**Phaseë³„ í™•ë³´ ì „ëµ**:
```yaml
Week 1 (30ê°œ):
  - ì¼ë°˜ì˜ì•½í’ˆ ìœ„ì£¼
  - ëŒ€í˜• ì•½êµ­ 3ê³³
  - ì˜ˆì‚°: 50,000ì›

Week 2 (40ê°œ):
  - ì „ë¬¸ì˜ì•½í’ˆ í¬í•¨
  - ë³‘ì› ì•½êµ­ í˜‘ì¡°
  - ë„ë§¤ìƒ ìƒ˜í”Œ
  - ì˜ˆì‚°: 70,000ì›

Week 3 (30ê°œ):
  - í¬ê·€ ì•½í’ˆ
  - íŠ¹ìˆ˜ ì œí˜•
  - ì˜¨ë¼ì¸ êµ¬ë§¤
  - ì˜ˆì‚°: 50,000ì›
```

**í˜‘ë ¥ ë„¤íŠ¸ì›Œí¬**:
- ì§€ì—­ ì•½ì‚¬íšŒ í˜‘ì¡° ìš”ì²­
- ì˜ì•½í’ˆ ë„ë§¤ìƒ ì»¨íƒ
- ì œì•½íšŒì‚¬ ìƒ˜í”Œ ìš”ì²­
- ë³‘ì› ì•½ì œë¶€ í˜‘ë ¥

**ì˜ˆì‚° ê³„íš**:
| í•­ëª© | ê¸ˆì•¡ | ë¹„ê³  |
|------|------|------|
| ì•½í’ˆ êµ¬ë§¤ | 150,000ì› | 100ê°œ |
| ìƒ˜í”Œ/ê¸°ë¶€ | 0ì› | í˜‘ì¡° |
| ë°°ì†¡ë¹„ | 20,000ì› | |
| ë³´ê´€ìš©í’ˆ | 10,000ì› | ë°•ìŠ¤, ì§€í¼ë°± |
| **ì´ê³„** | **180,000ì›** | |

---

#### Task 6: ì¼ì¼ 20ê°œì”© 5ì¼ê°„ ì´¬ì˜

**5ì¼ ì§‘ì¤‘ ì´¬ì˜ ê³„íš**:

**Day 1 (ì›”) - ê³ ë¹ˆë„ ì§„í†µì œ**:
```yaml
ëŒ€ìƒ: íƒ€ì´ë ˆë†€, ë¶€ë£¨íœ, ë‚™ì„¼, íœì˜, ê²Œë³´ë¦° ë“±
ëª©í‘œ: 20ê°œ Ã— 15ì¥ = 300ì¥
íŠ¹ì§•: í¬ê¸° ì ë‹¹, ê°ì¸ ëª…í™•
ë‚œì´ë„: â˜…â˜†â˜†â˜†â˜†
```

**Day 2 (í™”) - ì†Œí™”ì œ/ìœ„ì¥ì•½**:
```yaml
ëŒ€ìƒ: ë² ì•„ì œ, í›¼ìŠ¤íƒˆ, ê°œë¹„ìŠ¤ì½˜, ë¬´ì½”ìŠ¤íƒ€ ë“±
ëª©í‘œ: 20ê°œ Ã— 15ì¥ = 300ì¥
íŠ¹ì§•: ë‹¤ì–‘í•œ ìƒ‰ìƒ, ì½”íŒ…
ë‚œì´ë„: â˜…â˜…â˜†â˜†â˜†
```

**Day 3 (ìˆ˜) - í•­ìƒì œ/ê°ê¸°ì•½**:
```yaml
ëŒ€ìƒ: ì•„ëª©ì‹œì‹¤ë¦°, ì„¸íŒŒí´ëŸ¬, ì½”ëŒ€ì›, í™”ì´íˆ¬ë²¤ ë“±
ëª©í‘œ: 20ê°œ Ã— 15ì¥ = 300ì¥
íŠ¹ì§•: ìº¡ìŠ å¤š, PTP í¬ì¥
ë‚œì´ë„: â˜…â˜…â˜…â˜†â˜†
```

**Day 4 (ëª©) - ë§Œì„±ì§ˆí™˜ì•½**:
```yaml
ëŒ€ìƒ: ì•„ìŠ¤í”¼ë¦°, ë¦¬í”¼í† , ë…¸ë°”ìŠ¤í¬, ë‹¤ì´ì•„ë²¡ìŠ¤ ë“±
ëª©í‘œ: 20ê°œ Ã— 15ì¥ = 300ì¥
íŠ¹ì§•: ì†Œí˜•, ë¶„í• ì„ 
ë‚œì´ë„: â˜…â˜…â˜…â˜…â˜†
```

**Day 5 (ê¸ˆ) - íŠ¹ìˆ˜ì œí˜•/ë³´ì¶©ì´¬ì˜**:
```yaml
ëŒ€ìƒ: ì„œë°©ì •, ì—°ì§ˆìº¡ìŠ, ì¬ì´¬ì˜ í•„ìš” ì•½í’ˆ
ëª©í‘œ: 20ê°œ Ã— 15ì¥ = 300ì¥
íŠ¹ì§•: íŠ¹ìˆ˜ ì½”íŒ…, ë¶ˆê·œì¹™ í˜•íƒœ
ë‚œì´ë„: â˜…â˜…â˜…â˜…â˜…
```

**ì¼ì¼ ì²´í¬ë¦¬ìŠ¤íŠ¸**:
```markdown
## Daily Checklist

### ì˜¤ì „ ì¤€ë¹„ (08:30-09:00)
- [ ] ì¥ë¹„ ì ê²€ (ì¹´ë©”ë¼, ì¡°ëª…)
- [ ] ì•½í’ˆ ì¤€ë¹„ (20ê°œ ì„¸íŠ¸)
- [ ] Flutter ì•± ì‹¤í–‰
- [ ] Supabase ì—°ê²° í™•ì¸

### ì´¬ì˜ ì„¸ì…˜ (09:00-17:00)
- [ ] Session 1: 09:00-10:30 (5ê°œ)
- [ ] Session 2: 10:30-12:00 (5ê°œ)
- [ ] Session 3: 13:00-14:30 (5ê°œ)
- [ ] Session 4: 14:30-16:00 (5ê°œ)
- [ ] QC & ì¬ì´¬ì˜: 16:00-17:00

### ë§ˆë¬´ë¦¬ (17:00-18:00)
- [ ] ë°ì´í„° ì—…ë¡œë“œ í™•ì¸
- [ ] í’ˆì§ˆ í†µê³„ ê¸°ë¡
- [ ] ì¬ì´¬ì˜ ë¦¬ìŠ¤íŠ¸ ì‘ì„±
- [ ] ì¥ë¹„ ì •ë¦¬
- [ ] ì¼ì¼ ë³´ê³ ì„œ ì‘ì„±
```

---

#### Task 7: í’ˆì§ˆ Aë“±ê¸‰ 70% ì´ìƒ í™•ë³´ ê²€ì¦

**í’ˆì§ˆ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ**:

```python
class QualityMonitor:
    def __init__(self):
        self.target_a_grade = 0.70
        self.minimum_photos_per_drug = 10

    def generate_daily_report(self, date):
        report = {
            'date': date,
            'total_photos': 0,
            'a_grade': 0,
            'b_grade': 0,
            'c_grade': 0,
            'a_grade_ratio': 0.0,
            'drugs_complete': 0,
            'drugs_incomplete': [],
            'retake_required': []
        }

        # ì¼ë³„ í†µê³„ ê³„ì‚°
        photos = self.get_photos_by_date(date)
        report['total_photos'] = len(photos)

        for photo in photos:
            if photo.grade == 'A':
                report['a_grade'] += 1
            elif photo.grade == 'B':
                report['b_grade'] += 1
            else:
                report['c_grade'] += 1

        report['a_grade_ratio'] = report['a_grade'] / report['total_photos']

        # ì•½í’ˆë³„ ì™„ì„±ë„ ì²´í¬
        drugs = self.get_unique_drugs(photos)
        for drug in drugs:
            drug_photos = self.get_drug_photos(drug)
            a_count = sum(1 for p in drug_photos if p.grade == 'A')

            if a_count >= 7:  # 70% of 10 photos
                report['drugs_complete'] += 1
            else:
                report['drugs_incomplete'].append({
                    'drug_id': drug,
                    'a_grade_count': a_count,
                    'needed': 7 - a_count
                })

        return report

    def generate_cumulative_stats(self):
        """ì „ì²´ ì§„í–‰ ìƒí™© í†µê³„"""
        return {
            'total_drugs_targeted': 100,
            'drugs_photographed': self.count_photographed_drugs(),
            'total_photos': self.count_total_photos(),
            'a_grade_photos': self.count_a_grade_photos(),
            'overall_a_ratio': self.calculate_overall_a_ratio(),
            'estimated_completion': self.estimate_completion_date(),
            'quality_trend': self.analyze_quality_trend()
        }
```

**í’ˆì§ˆ ê°œì„  ì•¡ì…˜ í”Œëœ**:

| Aë“±ê¸‰ ë¹„ìœ¨ | ìƒíƒœ | ì•¡ì…˜ |
|-----------|------|------|
| > 75% | ğŸŸ¢ ìš°ìˆ˜ | í˜„í–‰ ìœ ì§€ |
| 70-75% | ğŸŸ¡ ì–‘í˜¸ | ë¯¸ì„¸ ì¡°ì • |
| 60-70% | ğŸŸ  ì£¼ì˜ | í”„ë¡œí† ì½œ ì ê²€ |
| < 60% | ğŸ”´ ìœ„í—˜ | ì¦‰ì‹œ ê°œì„  í•„ìš” |

**ê°œì„  ì¡°ì¹˜**:
1. **ì¡°ëª… ë³´ê°•**: ì¶”ê°€ LED íŒ¨ë„
2. **ì•ˆì •í™”**: íƒ€ì´ë¨¸ ì´¬ì˜ ì‚¬ìš©
3. **êµìœ¡**: ì´¬ì˜ ê¸°ë²• ì¬êµìœ¡
4. **ì¥ë¹„ ì ê²€**: ë Œì¦ˆ ì²­ì†Œ, ìº˜ë¦¬ë¸Œë ˆì´ì…˜

---

#### Task 8: Supabase ì—…ë¡œë“œ ë° ë©”íƒ€ë°ì´í„° ì •ë¦¬

**ìë™ ì—…ë¡œë“œ íŒŒì´í”„ë¼ì¸**:

```dart
// Flutter ì•± - ìë™ ë™ê¸°í™”
class AutoUploadService {
  final _uploadQueue = Queue<PhotoData>();
  Timer? _uploadTimer;

  void startAutoUpload() {
    _uploadTimer = Timer.periodic(Duration(seconds: 30), (timer) async {
      if (_uploadQueue.isNotEmpty && await isNetworkAvailable()) {
        await processUploadQueue();
      }
    });
  }

  Future<void> processUploadQueue() async {
    while (_uploadQueue.isNotEmpty) {
      final photo = _uploadQueue.removeFirst();

      try {
        // 1. ì´ë¯¸ì§€ ì••ì¶• (í’ˆì§ˆ ìœ ì§€)
        final compressed = await compressImage(
          photo.imageBytes,
          quality: 85,
          maxWidth: 3000,
        );

        // 2. Supabase ì—…ë¡œë“œ
        final url = await supabase.uploadImage(
          compressed,
          photo.kcode,
          photo.angle,
        );

        // 3. ë©”íƒ€ë°ì´í„° ì €ì¥
        await supabase.saveMetadata(
          PhotoMetadata(
            kcode: photo.kcode,
            drugName: photo.drugName,
            imageUrl: url,
            angle: photo.angle,
            qualityGrade: photo.qualityGrade,
            qualityMetrics: photo.metrics,
            deviceInfo: getDeviceInfo(),
            cameraSettings: photo.cameraSettings,
            capturedAt: photo.timestamp,
          ),
        );

        // 4. ë¡œì»¬ DB ì—…ë°ì´íŠ¸
        await localDb.markAsUploaded(photo.id);

        print('âœ… Uploaded: ${photo.kcode}_${photo.angle}');
      } catch (e) {
        print('âŒ Upload failed: $e');
        _uploadQueue.add(photo); // ì¬ì‹œë„ íì— ì¶”ê°€
      }
    }
  }
}
```

**ë©”íƒ€ë°ì´í„° ì •ë¦¬ ë° ê²€ì¦**:

```sql
-- ì¼ì¼ ë°ì´í„° ê²€ì¦ ì¿¼ë¦¬
WITH daily_stats AS (
  SELECT
    DATE(captured_at) as capture_date,
    kcode,
    drug_name,
    COUNT(*) as total_photos,
    SUM(CASE WHEN quality_grade = 'A' THEN 1 ELSE 0 END) as a_grade,
    SUM(CASE WHEN quality_grade = 'B' THEN 1 ELSE 0 END) as b_grade,
    SUM(CASE WHEN quality_grade = 'C' THEN 1 ELSE 0 END) as c_grade,
    ARRAY_AGG(DISTINCT photo_angle) as angles
  FROM real_photo_metadata
  WHERE DATE(captured_at) = CURRENT_DATE
  GROUP BY DATE(captured_at), kcode, drug_name
)
SELECT
  capture_date,
  COUNT(DISTINCT kcode) as drugs_captured,
  SUM(total_photos) as total_photos,
  SUM(a_grade) as total_a_grade,
  ROUND(100.0 * SUM(a_grade) / SUM(total_photos), 2) as a_grade_percentage,
  ARRAY_AGG(
    CASE
      WHEN total_photos < 10 THEN kcode
      ELSE NULL
    END
  ) FILTER (WHERE total_photos < 10) as incomplete_drugs
FROM daily_stats
GROUP BY capture_date;
```

**ë°ì´í„° ë°±ì—… ì „ëµ**:
```bash
#!/bin/bash
# daily_backup.sh

DATE=$(date +%Y%m%d)
BACKUP_DIR="/backup/pillsnap/$DATE"

# 1. Supabase ë°ì´í„° Export
supabase db dump --project-ref xxxxx > "$BACKUP_DIR/database_$DATE.sql"

# 2. Storage íŒŒì¼ ë™ê¸°í™”
rclone sync supabase:pill-images "$BACKUP_DIR/images/"

# 3. ë©”íƒ€ë°ì´í„° JSON Export
psql $DATABASE_URL -c "
  COPY (
    SELECT json_agg(row_to_json(t))
    FROM real_photo_metadata t
    WHERE DATE(captured_at) = CURRENT_DATE
  ) TO '$BACKUP_DIR/metadata_$DATE.json'
"

# 4. ì••ì¶• ë° ì•”í˜¸í™”
tar -czf "$BACKUP_DIR.tar.gz" "$BACKUP_DIR"
gpg -c "$BACKUP_DIR.tar.gz"

echo "âœ… Backup completed: $BACKUP_DIR.tar.gz.gpg"
```

---

## ğŸ“Š ì„±ê³¼ ì§€í‘œ ë° ë§ˆì¼ìŠ¤í†¤

### ì£¼ìš” KPI

| ì§€í‘œ | ëª©í‘œ | ìµœì†Œ | ì¸¡ì • ë°©ë²• |
|------|------|------|-----------|
| **ì´ ì‚¬ì§„ ìˆ˜** | 1,350ì¥ | 1,000ì¥ | Supabase ì¹´ìš´íŠ¸ |
| **Aë“±ê¸‰ ë¹„ìœ¨** | 70% | 60% | í’ˆì§ˆ í†µê³„ |
| **ì•½í’ˆ ì»¤ë²„ë¦¬ì§€** | 100ê°œ | 90ê°œ | Unique K-CODE |
| **ì¼ì¼ ìƒì‚°ì„±** | 270ì¥/ì¼ | 200ì¥/ì¼ | ì¼ë³„ í†µê³„ |
| **ì—…ë¡œë“œ ì„±ê³µë¥ ** | 99% | 95% | ì‹¤íŒ¨ ë¡œê·¸ |

### ì²´í¬í¬ì¸íŠ¸

**íŒŒì¼ëŸ¿ ì™„ë£Œ (Day 2)**:
- [ ] 30ê°œ ì•½í’ˆ ì´¬ì˜ ì™„ë£Œ
- [ ] 300ì¥ ì´ìƒ í™•ë³´
- [ ] Aë“±ê¸‰ 60% ë‹¬ì„±
- [ ] í”„ë¡œí† ì½œ v2.0 í™•ì •

**ì¤‘ê°„ ì ê²€ (Day 5)**:
- [ ] 50ê°œ ì•½í’ˆ ì™„ë£Œ
- [ ] 650ì¥ ì´ìƒ í™•ë³´
- [ ] í’ˆì§ˆ íŠ¸ë Œë“œ ë¶„ì„
- [ ] ë¬¸ì œ ì•½í’ˆ ì‹ë³„

**ìµœì¢… ì™„ë£Œ (Day 7)**:
- [ ] 100ê°œ ì•½í’ˆ ì™„ë£Œ
- [ ] 1,000ì¥ ì´ìƒ í™•ë³´
- [ ] Aë“±ê¸‰ 70% ë‹¬ì„±
- [ ] ì „ì²´ ë°ì´í„° ê²€ì¦

## ğŸš¨ ë¦¬ìŠ¤í¬ ê´€ë¦¬

### ì˜ˆìƒ ë¬¸ì œ ë° ëŒ€ì‘

**ì•½í’ˆ í™•ë³´ ì‹¤íŒ¨**:
- ë¦¬ìŠ¤í¬: íŠ¹ì • ì•½í’ˆ êµ¬ë§¤ ë¶ˆê°€
- ëŒ€ì‘: ëŒ€ì²´ ì•½í’ˆ ë¦¬ìŠ¤íŠ¸ ì¤€ë¹„ (120ê°œ)

**í’ˆì§ˆ ê¸°ì¤€ ë¯¸ë‹¬**:
- ë¦¬ìŠ¤í¬: Aë“±ê¸‰ 60% ë¯¸ë§Œ
- ëŒ€ì‘: ì¶”ê°€ ì´¬ì˜ì¼ í™•ë³´, ì¥ë¹„ ì—…ê·¸ë ˆì´ë“œ

**ì¥ë¹„ ê³ ì¥**:
- ë¦¬ìŠ¤í¬: ìŠ¤ë§ˆíŠ¸í° ê³ ì¥
- ëŒ€ì‘: ë°±ì—… ë””ë°”ì´ìŠ¤ ì¤€ë¹„ (êµ¬í˜• ìŠ¤ë§ˆíŠ¸í°)

**ë°ì´í„° ì†ì‹¤**:
- ë¦¬ìŠ¤í¬: ì—…ë¡œë“œ ì‹¤íŒ¨, ë¡œì»¬ ì†ìƒ
- ëŒ€ì‘: ì‹¤ì‹œê°„ ë°±ì—…, ë‹¤ì¤‘ ì €ì¥ì†Œ

## ğŸ“ ì‚°ì¶œë¬¼

1. **ë°ì´í„°ì…‹**:
   - 1,000+ ê³ í’ˆì§ˆ ì‹¤ì‚¬ì§„
   - 100ê°œ ì•½í’ˆ ì™„ì „ ì»¤ë²„
   - Aë“±ê¸‰ 70% ì´ìƒ

2. **ë©”íƒ€ë°ì´í„°**:
   - ì™„ì „í•œ EXIF ì •ë³´
   - í’ˆì§ˆ ì ìˆ˜ ë° ë©”íŠ¸ë¦­
   - ì´¬ì˜ ì¡°ê±´ ê¸°ë¡

3. **ë¬¸ì„œ**:
   - ì´¬ì˜ í”„ë¡œí† ì½œ v2.0
   - í’ˆì§ˆ ë¶„ì„ ë¦¬í¬íŠ¸
   - ê°œì„  ì œì•ˆì„œ

## ğŸ”— ë‹¤ìŒ ë‹¨ê³„
Phase 4: ëª¨ë¸ í•™ìŠµ - ì‹¤ì‚¬ì§„ í†µí•© í•™ìŠµ ë° ì„±ëŠ¥ ìµœì í™”